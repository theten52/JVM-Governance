# 7 主要并发收集器

Java HotSpot 虚拟机在 JDK 8 中有两个主要并发收集器：

- 并发标记清除（CMS）收集器：此收集器适用于那些希望垃圾回收暂停时间更短，并且能够承受与垃圾回收共享处理器资源的应用程序。

- Garbage-First （G1）垃圾收集器：这种服务器风格的收集器适用于具有大内存的多处理器机器。它能以高概率满足垃圾收集暂停时间目标，同时实现高吞吐量。

## 并发开销

主要并发收集器（The mostly concurrent collector）会用处理器资源（否则这些资源可被应用程序使用）来换取更短的主要收集暂停时间。最明显的开销是在收集的并发阶段使用一个或多个处理器。在一个拥有 N 个处理器的系统中，收集的并发部分将使用可用处理器的 K/N，其中 1 <= K <= ceiling{N/4}。（请注意，K 的精确选择和边界可能会发生变化。）除了在并发阶段使用处理器之外，为了实现并发还会产生额外的开销。因此，虽然使用并发收集器时垃圾收集暂停时间通常要短得多，但应用程序的吞吐量往往也会比使用其他收集器时略低。

在具有多个处理核心的机器上，在垃圾收集的并发阶段，处理器可用于应用程序线程，因此并发垃圾收集器线程不会“暂停”应用程序。这通常会使暂停时间更短，但同样，应用程序可用的处理器资源会减少，并且应该预计到会有一定的性能下降，特别是当应用程序最大限度地使用所有处理核心时。随着 N 的增加，并发垃圾收集导致的处理器资源减少会变小，并发收集带来的好处会增加。《并发标记清除（CMS）收集器中的并发模式失败》一节讨论了这种扩展的潜在限制。

由于在并发阶段至少有一个处理器用于垃圾回收，因此并发收集器通常在单处理器（单核）机器上不会带来任何好处。但是，CMS（而非 G1）有一个单独的模式，该模式可以在只有一两个处理器的系统上实现低停顿；详情请参阅并发标记清除（CMS）收集器中的增量模式。此功能在 Java SE 8 中已被弃用，可能会在后续的主要版本中移除。

## 额外参考资料

G1 垃圾回收器： 注：“Garbage-First Garbage Collector” 一般简称为 “G1 垃圾回收器”，这是技术领域的特定术语
```
http://www.oracle.com/technetwork/java/javase/tech/g1-intro-jsp-135488.html todo 翻译此链接
```

G1 垃圾收集器调优：

```
http://www.oracle.com/technetwork/articles/java/g1gc-1984535.html todo 翻译此链接
```